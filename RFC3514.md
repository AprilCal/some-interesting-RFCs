                                                           INFORMATIONAL<br>
                                                            Errata Exist<br>
Network Working Group                                        S. Bellovin<br>
Request for Comments: 3514                            AT&T Labs Research<br>
Category: Informational                                     1 April 2003


# IPv4首部安全标志
                  
## 文档状态
本备忘录为因特网社区提供信息。其不指定任何因特网标准。本文档发布不受限制。

## 版权声明
Copyright （C） The Internet Society（2000）。版权保留。

## 摘要
防火墙，包过滤，入侵检测系统以及类似系统常常难以区分有恶意的数据包和仅仅只是不正常的包。我们在IPv4首部定义一个安全标志来作为区分这两种包的方法。

## 1. 介绍
防火墙[CBR03]，包过滤，入侵检测系统以及类似系统常常难以区分有恶意的数据包和仅仅只是不正常的包。这个问题令此类抉择变得困难。为解决此问题，我们在IPv4首部定义一个名为“有害（evil）”位的安全标志。无恶意的数据包将此为置为0；用于攻击的数据包将此为置为1。

### 1.1. 术语Terminology
本文档中的关键字“MUST”,“MUST NOT”,“REQUIRED”,“SHALL”,“SHALL NOT”,“SHOULD”,“SHOULD NOT”,“RECOMMENDED”,“MAY”和“OPTIONAL” 将在[RFC2119]的描述中解释。

## 2. 语法
IP片偏移字段中的高位是IP首部唯一没有使用的位。因此，此位的选择不归IANA管。<br>
该字段如下：

             0
            +-+
            |E|
            +-+

目前指定的值定义如下：<br>
0x0 如果此位置为0，则此数据包没有恶意。主机，其他网络元素等等，应当（SHOULD）认为此包是无害的，并且不应当（SHOULD NOT）采取任何防御措施。（我们注意到，很多常见的桌面操作系统已经实现了说明的这一部分）。<br>
0x1 如果此位置为1，则此数据包是有恶意的。安全系统应当（SHOULD）设法保护自己免受此类包的攻击。不安全的系统可以（MAY）直接选择崩溃，被渗透等等。

## 3. 设置有害位（Evil Bit）

有许多设置有害位的方法。攻击程序可以使用适当的API要求设置此位。没有其他机制的系统必须（MUST）提供此类API；攻击程序必须（MUST）使用此API来设置有害位。<br>
多级的不安全操作系统可能有用于攻击程序的特殊级别；在此级别下，有害位必须（MUST）由运行的程序在发出包时默认设置。然而，此类系统可以（MAY）提供一个允许从事攻击行为的用户将有害位清除的API，以便其从事无恶意的活动。<br>
分片本身是危险的则必须（MUST）设置有害位。如果一个有害的数据包被中间路由器分片，并且分片本身并不危险，则必须（MUST）清除有害位，并且有害位在包重组后必须（MUST）重置。<br>
中间系统有时被用来清洗攻击连接。通过此类系统来中继，意图发往目标系统的数据包，应当（SHOULD）设置有害位。<br>
有些应用程序手动构造数据包。如果此类数据包是攻击的一部分，则应用程序必须自己（MUST）设置有害位。<br> 
在被防火墙保护的网络中，显然所有的攻击者都在防火墙之外。因此，防火墙内部的主机一定不能（MUST NOT）设置有害位。<br>
由于NAT[RFC3022]会修改数据包，他们应当为此类数据包设置有害位。“透明（Transparent）”http和邮件代理应当（SHOULD）为其发往无辜的客户的答复包设置有害位。<br>
一些主机用一种可以引起入侵检测系统警觉的方式来扫描其他主机。如果此类扫描是无害的搜索，一定不能（MUST NOT）设置有害位。如果扫描本身是无害的，但是最终目的是有害的，并且目标站点也有入侵检测系统，则应当（SHOULD）设置有害位。

4. Processing of the Evil Bit

   Devices such as firewalls MUST drop all inbound packets that have the
   evil bit set.  Packets with the evil bit off MUST NOT be dropped.
   Dropped packets SHOULD be noted in the appropriate MIB variable.

   Intrusion detection systems (IDSs) have a harder problem.  Because of
   their known propensity for false negatives and false positives, IDSs
   MUST apply a probabilistic correction factor when evaluating the evil
   bit.  If the evil bit is set, a suitable random number generator
   [RFC1750] must be consulted to determine if the attempt should be
   logged.  Similarly, if the bit is off, another random number
   generator must be consulted to determine if it should be logged
   despite the setting.

   The default probabilities for these tests depends on the type of IDS.
   Thus, a signature-based IDS would have a low false positive value but
   a high false negative value.  A suitable administrative interface
   MUST be provided to permit operators to reset these values.

   Routers that are not intended as as security devices SHOULD NOT
   examine this bit.  This will allow them to pass packets at higher
   speeds.

   As outlined earlier, host processing of evil packets is operating-
   system dependent; however, all hosts MUST react appropriately
   according to their nature.

5. Related Work

   Although this document only defines the IPv4 evil bit, there are
   complementary mechanisms for other forms of evil.  We sketch some of
   those here.

   For IPv6 [RFC2460], evilness is conveyed by two options.  The first,
   a hop-by-hop option, is used for packets that damage the network,
   such as DDoS packets.  The second, an end-to-end option, is for
   packets intended to damage destination hosts.  In either case, the

   option contains a 128-bit strength indicator, which says how evil the
   packet is, and a 128-bit type code that describes the particular type
   of attack intended.

   Some link layers, notably those based on optical switching, may
   bypass routers (and hence firewalls) entirely.  Accordingly, some
   link-layer scheme MUST be used to denote evil.  This may involve evil
   lambdas, evil polarizations, etc.

   DDoS attack packets are denoted by a special diffserv code point.

   An application/evil MIME type is defined for Web- or email-carried
   mischief.  Other MIME types can be embedded inside of evil sections;
   this permit easy encoding of word processing documents with macro
   viruses, etc.

6. IANA Considerations

   This document defines the behavior of security elements for the 0x0
   and 0x1 values of this bit.  Behavior for other values of the bit may
   be defined only by IETF consensus [RFC2434].

7. Security Considerations

   Correct functioning of security mechanisms depend critically on the
   evil bit being set properly.  If faulty components do not set the
   evil bit to 1 when appropriate, firewalls will not be able to do
   their jobs properly.  Similarly, if the bit is set to 1 when it
   shouldn't be, a denial of service condition may occur.

8. References

   [CBR03]   W.R. Cheswick, S.M. Bellovin, and A.D. Rubin, "Firewalls
             and Internet Security: Repelling the Wily Hacker", Second
             Edition, Addison-Wesley, 2003.

   [RFC791]  Postel, J., "Internet Protocol", STD 5, RFC 791, September
             1981.

   [RFC1750] Eastlake, D., 3rd, Crocker, S. and J. Schiller, "Randomness
             Recommendations for Security", RFC 1750, December 1994.

   [RFC2119] Bradner, S., "Key words for use in RFCs to Indicate
             Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2434] Narten, T. and H. Alvestrand, "Guidelines for Writing an
             IANA Considerations Section in RFCs", BCP 26, RFC 2434,
             October 1998.

   [RFC2460] Deering, S. and R. Hinden, "Internet Protocol, Version 6
             (IPv6) Specification", RFC 2460, December 1998.

   [RFC3022] Srisuresh, P. and K. Egevang, "Traditional IP Network
             Address Translator (Traditional NAT)", RFC 3022, January
             2001.

9. Author's Address

   Steven M. Bellovin
   AT&T Labs Research
   Shannon Laboratory
   180 Park Avenue
   Florham Park, NJ 07932

   Phone: +1 973-360-8656
   EMail: bellovin@acm.org
   
10. Full Copyright Statement

   Copyright (C) The Internet Society (2003).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.
